(window.webpackJsonp=window.webpackJsonp||[]).push([[6,3],{287:function(t,e,o){var content=o(290);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,o(103).default)("8bb0e4fe",content,!0,{sourceMap:!1})},289:function(t,e,o){"use strict";o(287)},290:function(t,e,o){var n=o(102)(!1);n.push([t.i,'#editor[data-v-2285dd0c]{font-size:1.1em;font-family:"Sorts Mill Goudy","Georgia",serif;border-radius:5px;height:calc(100vh - 120px);padding:80px 60px 200px;background-color:#fff}*[data-v-2285dd0c] h1,*[data-v-2285dd0c] h2,*[data-v-2285dd0c] h3,*[data-v-2285dd0c] h4,*[data-v-2285dd0c] h5,*[data-v-2285dd0c] h6{margin-top:1.5em;margin-bottom:.5em}*[data-v-2285dd0c] .comment{color:#5f9ea0}*[data-v-2285dd0c] li{margin-left:1em}*[data-v-2285dd0c] li+p{margin-top:1em}',""]),t.exports=n},298:function(t,e,o){var content=o(340);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,o(103).default)("1b7833da",content,!0,{sourceMap:!1})},300:function(t,e,o){"use strict";o.r(e);o(17),o(16),o(12),o(30),o(20),o(15),o(36);var n={props:["value","disabled","disableFormatting","refresh"],data:function(){return{content:this.value}},computed:{html:function(){var t,e=this,content=this.content;return content?content=(content=null===(t=content)||void 0===t?void 0:t.split(/\n+/).map((function(t){var o,n="p",r="",c=/^(#+) /,l=null===(o=c.exec(t))||void 0===o?void 0:o[1].length,d=/^(\*) /,h=/^(\[)(.+)(\])$/;if(!e.disableFormatting){var m=function(text){return'<span style="color: #ccc">'.concat(text,"</span>")};if(l?(n="h".concat(l),t=t.replace(c,m("$1 "))):d.test(t)?(n="li",t=t.replace(d,m("$1 "))):h.test(t)&&(t=t.replace(h,'<button class="btn btn-primary">'.concat(m("$1"),"$2").concat(m("$3"),"</button>"))),t.trim()){var v,f=/(\*{1,2})(\S.*?\S)(\*{1,2})/g,y=null===(v=f.exec(t))||void 0===v?void 0:v[1].length,w=/(\[)(.+?)(\]\(.+?\))/g,_=/(==)(.+?)(==)/g;if(y){var x=["em","strong"][y-1];t=t.replace(f,"".concat(m("$1"),"<").concat(x,">$2</").concat(x,">").concat(m("$3")))}w.test(t)&&(t=t.replace(w,"".concat(m("$1"),'<a href="$4">$2</a>').concat(m("$3")))),_.test(t)&&(t=t.replace(_,"".concat(m("$1"),"<mark>$2</mark>").concat(m("$3"))))}else r=' style="min-height: 1em"'}return"<".concat(n).concat(r,">").concat(t,"</").concat(n,">")})).join("\n")).replace(/\/\*[\s\S]*?\*\//g,'<small class="comment">$&</small>'):""}},methods:{blur:function(t){document.activeElement!==t.target&&(this.content=this.value)}},watch:{refresh:function(){this.content=this.value}}},r=(o(289),o(65)),component=Object(r.a)(n,(function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"cool-shadow",style:{"background-color":t.disabled?"#eee":"#fff",overflowY:"scroll"},attrs:{id:"editor"}},[o("div",{staticStyle:{outline:"none"},attrs:{contenteditable:!t.disabled},domProps:{innerHTML:t._s(t.html)},on:{input:function(e){return t.$emit("input",e.target.innerText)},blur:t.blur}})])}),[],!1,null,"2285dd0c",null);e.default=component.exports},339:function(t,e,o){"use strict";o(298)},340:function(t,e,o){var n=o(102)(!1);n.push([t.i,'[contenteditable]:empty:after{content:"Hello world!";color:#999}.full-height{height:calc(100vh - 48px)}.ql-toolbar{display:none}.cool-shadow{box-shadow:0 2px 5px -1px rgba(50,50,93,.25),0 1px 3px -1px rgba(0,0,0,.3)}',""]),t.exports=n},344:function(t,e,o){"use strict";o.r(e);o(5),o(4),o(6),o(7);var n=o(0),r=o(32),c=o(33),l=(o(301),o(16),o(2),o(1),o(57),o(163),o(131),o(220),o(36),o(17),o(12),o(30),o(20),o(165),o(39),o(15),o(302),o(303),o(305),o(309),o(311),o(312),o(313),o(316),o(317),o(318),o(319),o(320),o(321),o(322),o(323),o(325),o(326),o(327),o(328),o(329),o(330),o(331),o(332),o(333),o(334),o(335),o(3),o(336)),d=o.n(l),h=o(343),m=o(338),v=o.n(m);function f(object,t){var e=Object.keys(object);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(object);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(object,t).enumerable}))),e.push.apply(e,o)}return e}function y(t){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?f(Object(source),!0).forEach((function(e){Object(n.a)(t,e,source[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(source)):f(Object(source)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(source,e))}))}return t}var w=d.a.findIndex;function _(){return{content:"",created:Date.now(),id:1e3*Math.round(Date.now()+Math.random()),history:[{time:0,content:""}]}}var x={head:function(){var t,e="";return this.doc&&(e=(this.computeTitle(this.doc)||this.createdDateAndTime(null===(t=this.doc)||void 0===t?void 0:t.created))+" · "),{title:e+"Write."}},data:function(){return{mounted:!1,showSidebar:null,width:null,tempContent:null,workspaceTop:0,docs:null,doc:null,docChanged:!0,window:null,docTimer:null,idleTimer:null,historyPreview:null,showHistoryChart:!0,historyChart:null,autoStartDocTimer:!0,disableFormatting:!1,console:console,document:document,chartMode:1,saved:!0}},mounted:function(){var t=this;this.docs=d()(localStorage).keys().filter((function(t){return t.startsWith("doc_")})).map((function(t){return JSON.parse(localStorage.getItem(t))})).value(),this.docs.length||(this.docs=[_()]),this.doc=d.a.find(this.docs,{id:Number(this.$route.query.id||localStorage.getItem("lastDocId"))})||this.docs[0];var e=function(){t.width=window.innerWidth,t.workspaceTop=document.getElementById("workspace").offsetTop,t.showSidebar=t.width>=768};window.addEventListener("resize",e),window.onbeforeunload=function(e){if(e.preventDefault(),!t.saved)return"You have unsaved changes. Are you sure you want to leave?"},console.log("beforeunload listener added"),this.window=window,this.mounted=!0,this.$nextTick((function(){e(),t.$watch("chartConfig",{immediate:!0,handler:function(t){var e=document.getElementById("history-chart");this.historyChart?(Object.assign(this.historyChart,t),this.historyChart.update()):this.historyChart=new h.a(e,t)}})}))},computed:{content:{get:function(){return(this.historyPreview||this.doc).content.trim()},set:function(t){(this.historyPreview||this.doc).content=t}},formattedContent:{get:function(){var content=this.content;return content=content.split("\n+").map((function(t){return"<p>".concat(t,"</p>")})).join("\n")||"<p></p>"},set:function(t){this.content=t.replace(/(?!\*\*)(<strong>.+?<\/strong>(?!\*\*))/g,"**$1**")}},docTimeAsHHMMSS:{get:function(){return this.timeAsHHMMSS(this.doc.time)},set:function(t){var e=this.doc;if(t.match(/^\d\d?:\d\d:\d\d$/)){var o=t.split(":"),n=Object(c.a)(o,3),r=n[0],l=n[1],d=n[2];e.time=3600*Number(r)+60*Number(l)+Number(d)}}},wordcount:function(){var content=(this.historyPreview||this.doc).content;return this.getWordcount(content)},chartConfig:function(){var t,e=this,o=this.chartMode;return{type:"scatter",data:{datasets:[{label:o?"Words vs minutes":"Words per hour vs words",backgroundColor:"rgba(54,162,235,0.2)",borderColor:"rgba(54,162,235,1)",data:Object(r.a)(null===(t=this.doc.history)||void 0===t?void 0:t.map((function(t){var time=t.time,content=t.content,n=e.getWordcount(content);return o?{x:time/60,y:n}:{x:n,y:n/(time/3600)}})))}]},options:{animation:{duration:0},scales:{x:{min:0},y:{min:0}},onHover:function(t,o){var n=Object(c.a)(o,1)[0];if(n){var r=e.doc.history[n.index];e.historyPreview=r}else{var l=e.historyPreview;setTimeout((function(){e.historyPreview==l&&(e.historyPreview=null)}),1e3)}}}}}},methods:{computeTitle:function(t){var e,o;return null==t||null===(e=t.content)||void 0===e||null===(o=e.match(/\w.*\w/))||void 0===o?void 0:o[0]},createdDateAndTime:function(t){return new Date(t.created).toLocaleString("en-US",{weekday:"short",month:"short",day:"numeric",hour:"numeric",minute:"numeric",hour12:!0})},pruneHistory:function(){for(var t=this.doc.history,i=1;i<t.length;){t[i].time-t[i-1].time<60?(this.$delete(t,i),this.saved=!1):(this.$set(t[i],"delta",this.withDelta("create",t[i-1].content,t[i].content)),i++)}},copyToClipboard:function(text){navigator.clipboard.writeText(text),this.$bvToast.toast("Copied to clipboard",{title:"Copied!",autoHideDelay:2e3,appendToast:!0,variant:"success"})},startDocTimer:function(){var t=this;void 0===this.doc.time&&this.$set(this.doc,"time",0),this.docTimer||(this.docTimer=setInterval((function(){t.doc.time+=1}),1e3))},timeAsHHMMSS:function(time){if(!time)return"--:--:--";var t=Math.floor(time/3600),e=Math.floor((time-3600*t)/60),o=time-3600*t-60*e;return"".concat(t,":").concat(e<10?"0":"").concat(e,":").concat(o<10?"0":"").concat(o)},removeComments:function(content){return content=(content=(content=content.replace(/\/\*[\s\S]*?\*\//g,"")).replace(/\n{3,}/g,"\n\n")).trim()},getWordcount:function(content){var t;return null!==(t=content)&&void 0!==t&&t.trim()?(content=this.removeComments(content)).split(/[^\w-]+/).filter((function(t){return t.trim()})).length:0},withDelta:function(t){for(var e=arguments.length,o=new Array(e>1?e-1:0),n=1;n<e;n++)o[n-1]=arguments[n];var c=o.map((function(text){var t;return null===(t=new TextEncoder)||void 0===t?void 0:t.encode(text)})),l=v.a[t].apply(v.a,Object(r.a)(c)),d=(new TextDecoder).decode(Uint8Array.from(l));return d},save:function(){var t=this,e=this.doc,o=e.history||this.$set(e,"history",[]),time=e.time,content=e.content;o.push({time:time,content:content,delta:o.length&&this.withDelta("create",o[o.length-1].content,content)}),localStorage.setItem("doc_".concat(e.id),JSON.stringify(y(y({},e),{},{history:d.a.map(e.history,(function(t,i){return i?d.a.omit(t,"content"):t}))}))),console.log("Saved!"),this.$nextTick((function(){return t.saved=!0}))},newDoc:_,without:d.a.without,findIndex:w},watch:{"doc.id":{handler:function(){this.tempContent=this.doc.content,this.$nextTick((function(){var t;null===(t=document.getElementById("editor"))||void 0===t||t.focus()})),localStorage.setItem("lastDocId",this.doc.id);for(var t=this.doc.history,i=1;i<(null==t?void 0:t.length);i++){var e=[i-1,i].map((function(e){return t[e].content})),o=Object(c.a)(e,2),n=o[0],r=o[1],l=t[i].delta,d=void 0!==l,h=d?"content":"delta",m=this.withDelta(d?"apply":"create",n,d?l:r);this.$set(t[i],h,m)}this.docChanged=!0}},"doc.content":{handler:function(){this.doc;if(this.docChanged)return this.docChanged=!1,void(this.saved=!0);this.saved=!1,clearTimeout(this.idleTimer),this.idleTimer=setTimeout(this.save,5e3),this.autoStartDocTimer&&this.startDocTimer()}},docs:{handler:function(t){d()(localStorage).keys().filter((function(t){return t.startsWith("doc_")})).filter((function(e){return!t.find((function(t){return t.id===parseInt(e.replace("doc_",""))}))})).forEach((function(t){return localStorage.removeItem(t)}))}}}},S=x,C=(o(339),o(65)),component=Object(C.a)(S,(function(){var t=this,e=t.$createElement,o=t._self._c||e;return t.doc?o("b-container",{staticClass:"px-0",staticStyle:{overflow:"hidden"},attrs:{fluid:""},on:{keydown:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"s",void 0,e.key,void 0)?null:e.ctrlKey?(e.preventDefault(),t.save.apply(null,arguments)):null}}},[o("div",{staticClass:"d-flex justify-content-start align-items-center sticky-top pb-1 border"},[o("b-button",{staticClass:"m-1",attrs:{size:"sm",variant:t.showSidebar?"outline-secondary":"light"},on:{click:function(){return t.showSidebar=!t.showSidebar}}},[t._v("\n      ≡\n    ")]),t._v(" "),o("b-button",{staticClass:"m-1",attrs:{size:"sm",variant:t.docTimer?"outline-danger":"success"},on:{click:function(){t.docTimer?(t.window.clearInterval(t.docTimer),t.docTimer=null,t.saved=!1):t.startDocTimer()}}},[t._v("\n      "+t._s(t.docTimer?"Stop timer":"Start timer")+"\n    ")]),t._v(" "),o("b-form-input",{staticClass:"m-1",staticStyle:{"max-width":"100px"},attrs:{type:"text",size:"sm",variant:"outline-secondary"},model:{value:t.docTimeAsHHMMSS,callback:function(e){t.docTimeAsHHMMSS=e},expression:"docTimeAsHHMMSS"}}),t._v(" "),o("b-check",{staticClass:"m-1",attrs:{size:"sm",variant:"outline-secondary",switch:""},model:{value:t.autoStartDocTimer,callback:function(e){t.autoStartDocTimer=e},expression:"autoStartDocTimer"}},[t._v("\n      Start on input\n    ")])],1),t._v(" "),o("b-row",{staticClass:"full-height px-2",style:{"--full-height":"calc(100vh - "+t.workspaceTop+"px)"},attrs:{id:"workspace"}},[o("b-col",{directives:[{name:"show",rawName:"v-show",value:t.showSidebar,expression:"showSidebar"}],class:{"position-absolute":t.width<768,"cool-shadow bg-white full-height":!0},style:{opacity:t.width<768&&.9,overflowY:"auto",fontSize:"0.7em",zIndex:1},attrs:{cols:"8",md:"5",lg:"4",xl:"3"}},[t._l(t.docs,(function(e,n){return o("b-row",{key:n},[o("b-col",{staticClass:"p-2",style:Object.assign({},{cursor:"pointer",overflow:"hidden","white-space":"nowrap","text-overflow":"ellipsis"},!e.content.trim()&&{"font-style":"italic",color:"#868686"},e===t.doc&&{"font-weight":"bold"}),attrs:{cols:"9"},domProps:{textContent:t._s(t.computeTitle(e)||t.createdDateAndTime(e))},on:{click:function(o){t.doc=e,t.$router.push({query:{id:e.id}})}}}),t._v(" "),o("b-col",[t.docs.length>1?o("b-button-close",{attrs:{size:"sm"},on:{click:function(o){t.window.confirm("Are you sure? THERE IS NO UNDO!")&&(t.doc=t.docs[n-1]||t.docs[n+1]||null,t.docs=t.without(t.docs,e))}}}):t._e()],1)],1)})),t._v(" "),o("b-button",{staticClass:"mt-2",attrs:{size:"sm",variant:"outline-secondary"},on:{click:function(e){t.doc=t.newDoc(),t.docs=t.docs.concat([t.doc])}}},[t._v("\n        +\n      ")]),t._v(" "),t.doc.history&&t.doc.history.length?[o("h5",{staticClass:"mt-4"},[t._v("\n          Revision history\n        ")]),t._v(" "),o("b-button",{staticClass:"mt-2",attrs:{size:"sm",variant:"outline-secondary"},on:{click:function(e){t.showHistoryChart=!t.showHistoryChart}}},[t._v("\n          "+t._s(t.showHistoryChart?"Table":"Chart")+"\n        ")]),t._v(" "),o("canvas",{style:{display:t.showHistoryChart?"block":"none"},attrs:{id:"history-chart"}}),t._v(" "),t.showHistoryChart?t._e():o("b-table",{attrs:{"sort-by":"time","sort-desc":"",items:t.doc.history,fields:[{key:"time",label:"Time"},{key:"content",label:"Words",formatter:t.getWordcount},{key:"remove",label:""}]},scopedSlots:t._u([{key:"cell(time)",fn:function(e){var n=e.item;return[o("span",{style:{cursor:"pointer","font-weight":n===t.historyPreview?"bold":"normal"},domProps:{textContent:t._s(t.timeAsHHMMSS(n.time))},on:{click:function(e){t.historyPreview=n},mouseover:function(e){t.historyPreview=n},mouseleave:function(e){t.window.setTimeout((function(){t.historyPreview==n&&(t.historyPreview=null)}),1e3)}}})]}},{key:"cell(remove)",fn:function(e){var n=e.item;return[t.doc.history.indexOf(n)>0?o("b-button-close",{attrs:{size:"sm"},on:{click:function(){if(t.window.confirm("Are you sure? THERE IS NO UNDO!")){var i=t.doc.history.indexOf(n);t.doc.history=t.without(t.doc.history,n),t.$set(t.doc.history[i],"delta",t.withDelta("create",t.doc.history[i-1].content,t.doc.history[i].content)),t.saved=!1}}}}):t._e()]}}],null,!1,415612569)}),t._v(" "),t.historyPreview?o("b-button",{staticClass:"mt-2",attrs:{size:"sm",variant:"outline-secondary"},on:{click:function(e){t.historyPreview=null}}},[t._v("\n          Exit preview\n        ")]):t._e(),t._v(" "),o("b-button",{staticClass:"mt-2",attrs:{size:"sm",variant:"outline-secondary"},on:{click:function(e){t.window.confirm("Are you sure? THERE IS NO UNDO!")&&(t.doc.history=[])}}},[t._v("\n          Clear history\n        ")]),t._v(" "),o("b-button",{staticClass:"mt-2",attrs:{size:"sm",variant:"outline-secondary"},on:{click:function(e){t.copyToClipboard("hours\twords\n"+t.doc.history.map((function(e){return e.time/3600+"\t"+t.getWordcount(e.content)})).join("\n"))}}},[t._v("\n          Copy as TSV\n        ")]),t._v(" "),o("b-button",{staticClass:"mt-2",attrs:{size:"sm",variant:"outline-secondary"},on:{click:t.pruneHistory}},[t._v("\n          Prune history\n        ")]),t._v(" "),o("b-check",{staticClass:"mt-2",attrs:{value:0,"unchecked-value":1,switch:"",size:"sm",variant:"outline-secondary"},model:{value:t.chartMode,callback:function(e){t.chartMode=e},expression:"chartMode"}},[t._v("\n          Show wph vs words\n        ")])]:t._e()],2),t._v(" "),o("b-col",{staticClass:"full-height bg-light pt-4",staticStyle:{overflow:"auto"}},[o("div",{style:{maxWidth:"900px",margin:"0 auto"}},[o("Editor",t._b({attrs:{refresh:t.historyPreview&&t.historyPreview.time||t.doc.id},model:{value:(t.historyPreview||t.doc).content,callback:function(e){t.$set(t.historyPreview||t.doc,"content",e)},expression:"(historyPreview || doc).content"}},"Editor",{disableFormatting:t.disableFormatting},!1)),t._v(" "),o("div",{staticClass:"d-flex justify-content-start align-items-center sticky-top px-2 py-1 border",staticStyle:{gap:"1rem"}},[o("b-check",{attrs:{size:"sm",variant:"outline-secondary",switch:""},model:{value:t.disableFormatting,callback:function(e){t.disableFormatting=e},expression:"disableFormatting"}},[t._v("\n            Disable formatting\n          ")]),t._v(" "),o("b-button",{attrs:{size:"sm",variant:"outline-secondary"},on:{click:function(e){t.copyToClipboard(t.removeComments((t.historyPreview||t.doc).content))}}},[t._v("\n            Copy\n          ")]),t._v(" "),o("b-button",{attrs:{size:"sm",variant:t.saved?"light":"outline-danger",disabled:t.saved},on:{click:t.save}},[t._v("\n            "+t._s(t.saved?"All changes saved.":"Save")+"\n          ")]),t._v(" "),o("div",{staticClass:"small ml-auto text-muted"},[t._v("\n            "+t._s(t.wordcount)+" "+t._s(1===t.wordcount?"word":"words")+"\n            "),t._v("\n            ~"+t._s(10*Math.round(t.wordcount/(t.historyPreview||t.doc).time*3600/10))+" words/hour\n          ")])],1)],1)])],1)],1):t._e()}),[],!1,null,null,null);e.default=component.exports;installComponents(component,{Editor:o(300).default})}}]);